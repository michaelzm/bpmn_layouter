# BPMN Layouter

## Overview
BPMN Layouter is a Python-based tool that processes BPMN data in JSON format, structures it, computes positional data for elements, and writes it back to a BPMN XML file.

## Features
- Parses BPMN data from JSON format
- Generates incoming and outgoing flow connections for elements
- Converts structured BPMN JSON into a flattened dictionary
- Builds a tree representation of BPMN elements
- Computes and assigns positional data to elements
- Appends positional data to BPMN XML

## Installation
Ensure you have Python installed. Then, clone the repository and install the required dependencies:

```sh
# Clone the repository
git clone https://github.com/michaelzm/bpmn_layouter.git
cd bpmn_layouter

# Install dependencies
pip install -r requirements.txt
```

## Usage
### Running the Code
To process BPMN JSON data and generate a BPMN XML file with positional data, use the following approach:

```python
import json
from input_data import json_string_1
from xml_generator import json_to_flattened_dict, generate_flows_based_on_elements
from data_structure_methods import parse_tree, init_element_positions
from data_structures import Node

# Convert single quotes to double quotes to make it valid JSON
data = json_string_1.replace("'", '"')

# Parse JSON
parsed_json = json.loads(data)

# Initialize flow connections
for elem in parsed_json["elements"]:
    elem["outgoing_flows"] = []
    elem["incoming_flows"] = []

# Generate flow mappings
parsed_json = generate_flows_based_on_elements(parsed_json)

# Convert structured JSON to a flattened dictionary
flattened_dict = json_to_flattened_dict(parsed_json)

# Convert elements to nodes
elements_as_nodes = {element_id: Node(flattened_dict[element_id]) for element_id in flattened_dict}

# Parse the BPMN tree structure
elements_linked = parse_tree(elements_linked=elements_as_nodes)

# Compute positional data
elements_linked, id_depth_mapping = init_element_positions(elements_linked)

# Generate XML with positional data
from xml_generator import xml_position_appender, generate_top_bpmn_xml
top_xml_part = generate_top_bpmn_xml(elements_linked)
xml_position_appender(elements_linked, top_xml_part, "generated_bpmn_file.xml")
```

### Input
- **BPMN JSON Data:** The input data is provided as a JSON string stored in `input_data.py` as `json_string_1`.

### Output
- **generated_bpmn_file.xml**: The BPMN XML file generated with computed positional data.

## Contributing
Feel free to fork the repository and submit pull requests!

## License
This project is licensed under the Apache 2.0 License.

## Contact
For any questions, reach out via GitHub issues.

---
Modeled Layout:
<img width="1023" alt="Screenshot 2025-02-19 at 17 17 22" src="https://github.com/user-attachments/assets/24159112-0192-4dc8-9b67-db6d5d816785" />

Autogenerated Layout based on semantic BPMN part:
<img width="1008" alt="Screenshot 2025-02-19 at 17 17 16" src="https://github.com/user-attachments/assets/fd2a68dd-91f7-4b0e-a9da-af89d81874d9" />